Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [16:19<00:00,  5.00s/it]
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:58<00:00,  4.89s/it]
Loss Epoch: 1 Value: 1.708456354218117
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:55<00:00,  4.88s/it]
Loss Epoch: 2 Value: 0.1933772504681303
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:47<00:00,  4.83s/it]
Loss Epoch: 3 Value: 0.02812557150640974
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:50<00:00,  4.85s/it]
Loss Epoch: 4 Value: 0.00870000578410958
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:48<00:00,  4.84s/it]
Loss Epoch: 5 Value: 0.0037898318033531184
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [16:00<00:00,  4.90s/it]
Loss Epoch: 6 Value: 0.0018742894882999113
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:56<00:00,  4.88s/it]
Loss Epoch: 7 Value: 0.0011379720594773897
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [15:50<00:00,  4.85s/it]
Loss Epoch: 8 Value: 0.0006471738730972587
Updated
Training Procedure:  19%|█████████████████████████████████▌                                                                                                                                           | 38/196 [03:09<13:06,  4.98s/it]
Loss Epoch: 9 Value: 0.00040293114939138797
Updated
Traceback (most recent call last):                                                                                                                                                                                                     
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 206, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 156, in main
    _, metrics = train_lkis_task(
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 160, in train_lkis_task
    features = teacher_model_encoder(**inputs, output_hidden_states=True)["hidden_states"]  # Shape [batch_size, Seq + 1, 768] -> Shape [batch_size, 768] Get the cls
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_models.py", line 345, in forward
    output = self.model(pixel_values=pixel_values, labels=labels, return_dict=True)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 406, in forward
    outputs = self.resnet(pixel_values, output_hidden_states=output_hidden_states, return_dict=return_dict)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 347, in forward
    encoder_outputs = self.encoder(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 250, in forward
    hidden_state = stage_module(hidden_state)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 219, in forward
    hidden_state = layer(hidden_state)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1844, in _call_impl
    return inner()
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1803, in inner
    hook_result = hook(self, args, result)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_models.py", line 336, in _hook_fn
    self.pre_residuals.append(input[0].detach().cpu())
KeyboardInterrupt
