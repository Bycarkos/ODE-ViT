Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:46<00:00,  8.43s/it]
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:26<00:00,  8.23s/it]
Loss Epoch: 1 Value: 63.32842250016271
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:35<00:00,  8.32s/it]
Loss Epoch: 2 Value: 62.79846253443738
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:41<00:00,  8.39s/it]
Loss Epoch: 3 Value: 61.724935543780425
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:42<00:00,  8.39s/it]
Loss Epoch: 4 Value: 60.143276154386754
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:45<00:00,  8.42s/it]
Loss Epoch: 5 Value: 57.97788997633116
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:48<00:00,  8.46s/it]
Loss Epoch: 6 Value: 55.1895266570607
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [13:47<00:00,  8.45s/it]
Loss Epoch: 7 Value: 51.684828823318284
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:11<00:00,  8.69s/it]
Loss Epoch: 8 Value: 47.38900477636834
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:47<00:00,  9.06s/it]
Loss Epoch: 9 Value: 42.32300498138885
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:50<00:00,  9.09s/it]
Loss Epoch: 10 Value: 36.65206738622213
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:58<00:00,  9.17s/it]
Loss Epoch: 11 Value: 30.821805306083085
Updated
Training Procedure:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 84/98 [12:41<02:06,  9.07s/it]
Loss Epoch: 12 Value: 25.79235170990685
Updated
Traceback (most recent call last):                                                                                                                                                                                                     
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 203, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 153, in main
    _, metrics = train_lkis_task(
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 160, in train_lkis_task
    features = teacher_model_encoder(**inputs, output_hidden_states=True)["hidden_states"]  # Shape [batch_size, Seq + 1, 768] -> Shape [batch_size, 768] Get the cls
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_models.py", line 335, in forward
    output = self.model(pixel_values=pixel_values, labels=labels, return_dict=True)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 406, in forward
    outputs = self.resnet(pixel_values, output_hidden_states=output_hidden_states, return_dict=return_dict)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 347, in forward
    encoder_outputs = self.encoder(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 250, in forward
    hidden_state = stage_module(hidden_state)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 219, in forward
    hidden_state = layer(hidden_state)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1844, in _call_impl
    return inner()
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1803, in inner
    hook_result = hook(self, args, result)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_models.py", line 328, in _hook_fn
    self.post_residuals.append(output.detach().cpu())
KeyboardInterrupt
