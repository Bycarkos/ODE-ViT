Some weights of the model checkpoint at /data/users/cboned/checkpoints/Vit_CIFAR100_first_train_reduced.pt were not used when initializing ViTForImageClassification: ['vit.encoder.layer.1.attention.attention.key.bias', 'vit.encoder.layer.1.attention.attention.key.weight', 'vit.encoder.layer.1.attention.attention.query.bias', 'vit.encoder.layer.1.attention.attention.query.weight', 'vit.encoder.layer.1.attention.attention.value.bias', 'vit.encoder.layer.1.attention.attention.value.weight', 'vit.encoder.layer.1.attention.output.dense.bias', 'vit.encoder.layer.1.attention.output.dense.weight', 'vit.encoder.layer.1.intermediate.dense.bias', 'vit.encoder.layer.1.intermediate.dense.weight', 'vit.encoder.layer.1.layernorm_after.bias', 'vit.encoder.layer.1.layernorm_after.weight', 'vit.encoder.layer.1.layernorm_before.bias', 'vit.encoder.layer.1.layernorm_before.weight', 'vit.encoder.layer.1.output.dense.bias', 'vit.encoder.layer.1.output.dense.weight', 'vit.encoder.layer.10.attention.attention.key.bias', 'vit.encoder.layer.10.attention.attention.key.weight', 'vit.encoder.layer.10.attention.attention.query.bias', 'vit.encoder.layer.10.attention.attention.query.weight', 'vit.encoder.layer.10.attention.attention.value.bias', 'vit.encoder.layer.10.attention.attention.value.weight', 'vit.encoder.layer.10.attention.output.dense.bias', 'vit.encoder.layer.10.attention.output.dense.weight', 'vit.encoder.layer.10.intermediate.dense.bias', 'vit.encoder.layer.10.intermediate.dense.weight', 'vit.encoder.layer.10.layernorm_after.bias', 'vit.encoder.layer.10.layernorm_after.weight', 'vit.encoder.layer.10.layernorm_before.bias', 'vit.encoder.layer.10.layernorm_before.weight', 'vit.encoder.layer.10.output.dense.bias', 'vit.encoder.layer.10.output.dense.weight', 'vit.encoder.layer.11.attention.attention.key.bias', 'vit.encoder.layer.11.attention.attention.key.weight', 'vit.encoder.layer.11.attention.attention.query.bias', 'vit.encoder.layer.11.attention.attention.query.weight', 'vit.encoder.layer.11.attention.attention.value.bias', 'vit.encoder.layer.11.attention.attention.value.weight', 'vit.encoder.layer.11.attention.output.dense.bias', 'vit.encoder.layer.11.attention.output.dense.weight', 'vit.encoder.layer.11.intermediate.dense.bias', 'vit.encoder.layer.11.intermediate.dense.weight', 'vit.encoder.layer.11.layernorm_after.bias', 'vit.encoder.layer.11.layernorm_after.weight', 'vit.encoder.layer.11.layernorm_before.bias', 'vit.encoder.layer.11.layernorm_before.weight', 'vit.encoder.layer.11.output.dense.bias', 'vit.encoder.layer.11.output.dense.weight', 'vit.encoder.layer.2.attention.attention.key.bias', 'vit.encoder.layer.2.attention.attention.key.weight', 'vit.encoder.layer.2.attention.attention.query.bias', 'vit.encoder.layer.2.attention.attention.query.weight', 'vit.encoder.layer.2.attention.attention.value.bias', 'vit.encoder.layer.2.attention.attention.value.weight', 'vit.encoder.layer.2.attention.output.dense.bias', 'vit.encoder.layer.2.attention.output.dense.weight', 'vit.encoder.layer.2.intermediate.dense.bias', 'vit.encoder.layer.2.intermediate.dense.weight', 'vit.encoder.layer.2.layernorm_after.bias', 'vit.encoder.layer.2.layernorm_after.weight', 'vit.encoder.layer.2.layernorm_before.bias', 'vit.encoder.layer.2.layernorm_before.weight', 'vit.encoder.layer.2.output.dense.bias', 'vit.encoder.layer.2.output.dense.weight', 'vit.encoder.layer.3.attention.attention.key.bias', 'vit.encoder.layer.3.attention.attention.key.weight', 'vit.encoder.layer.3.attention.attention.query.bias', 'vit.encoder.layer.3.attention.attention.query.weight', 'vit.encoder.layer.3.attention.attention.value.bias', 'vit.encoder.layer.3.attention.attention.value.weight', 'vit.encoder.layer.3.attention.output.dense.bias', 'vit.encoder.layer.3.attention.output.dense.weight', 'vit.encoder.layer.3.intermediate.dense.bias', 'vit.encoder.layer.3.intermediate.dense.weight', 'vit.encoder.layer.3.layernorm_after.bias', 'vit.encoder.layer.3.layernorm_after.weight', 'vit.encoder.layer.3.layernorm_before.bias', 'vit.encoder.layer.3.layernorm_before.weight', 'vit.encoder.layer.3.
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loaded keys: <All keys matched successfully>
CREATING THE BASELINE METRIC VALUE
 STARTING TO EVALUATE FO THE FIRST TIME
val Procedure: 24it [00:02,  9.24it/s]
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:02<00:00,  2.46s/it]
Validation Loss Epoch: 0 Value: 5.566964168548584 Optimal_loss: 10000000000.0
val Procedure: 24it [00:02,  9.77it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:02<00:00,  1.97s/it]
Loss Epoch: 1 Value: 5.281647202919941
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:01<00:00,  2.46s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.8896799659729 Optimal_loss: 4.8896799659729
val Procedure: 24it [00:02,  9.77it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:01<00:00,  1.97s/it]
Loss Epoch: 2 Value: 4.715083543135195
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:00<00:00,  2.45s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.604463939666748 Optimal_loss: 4.604463939666748
val Procedure: 24it [00:02,  9.80it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:00<00:00,  1.97s/it]
Loss Epoch: 3 Value: 4.564169051695843
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:00<00:00,  2.45s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.53601957321167 Optimal_loss: 4.53601957321167
val Procedure: 24it [00:02,  9.74it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:00<00:00,  1.97s/it]
Loss Epoch: 4 Value: 4.496235404695783
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [09:09<00:00,  2.80s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.447788238525391 Optimal_loss: 4.447788238525391
val Procedure: 24it [00:02,  9.69it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [09:09<00:00,  2.00s/it]
Loss Epoch: 5 Value: 4.371181485604267
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.279661827087402 Optimal_loss: 4.279661827087402
val Procedure: 24it [00:07,  3.07it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  4.44s/it]
Loss Epoch: 6 Value: 4.22468664208237
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:47<00:00,  5.44s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.136706323623657 Optimal_loss: 4.136706323623657
val Procedure: 24it [00:07,  3.08it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:47<00:00,  4.44s/it]
Loss Epoch: 7 Value: 4.133401403621751
Training Procedure:  67%|██████████████████████████████████████████████████████████████████████████████████████████████████▉                                                 | 131/196 [12:04<05:59,  5.53s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.116843786239624 Optimal_loss: 4.116843786239624
Traceback (most recent call last):                                                                                                                                                                             
  File "/home/cboned/Projects/OCR-Koopman/main_classification_with_koopman.py", line 224, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_classification_with_koopman.py", line 162, in main
    _, train_loss = train_classification_with_koopman(
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 85, in train_classification_with_koopman
    total_loss = loss + (lambd * koopman_loss)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
