Config of the encoder: <class 'transformers.models.vit.modeling_vit.ViTModel'> is overwritten by shared encoder config: ViTConfig {
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 384,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "pooler_act": "tanh",
  "pooler_output_size": 768,
  "qkv_bias": false,
  "torch_dtype": "float32",
  "transformers_version": "4.51.1"
}

Config of the decoder: <class 'transformers.models.trocr.modeling_trocr.TrOCRForCausalLM'> is overwritten by shared decoder config: TrOCRConfig {
  "activation_dropout": 0.0,
  "activation_function": "relu",
  "add_cross_attention": true,
  "attention_dropout": 0.0,
  "bos_token_id": 0,
  "classifier_dropout": 0.0,
  "cross_attention_hidden_size": 768,
  "d_model": 1024,
  "decoder_attention_heads": 16,
  "decoder_ffn_dim": 4096,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 12,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "eos_token_id": 2,
  "init_std": 0.02,
  "is_decoder": true,
  "layernorm_embedding": false,
  "max_position_embeddings": 1024,
  "model_type": "trocr",
  "pad_token_id": 1,
  "scale_embedding": true,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.51.1",
  "use_cache": false,
  "use_learned_position_embeddings": false,
  "vocab_size": 50265
}

Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:42<00:00,  2.21s/it]
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:42<00:00,  2.21s/it]
Loss Epoch: 1 Value: 141.3733582151109
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 2 Value: 112.74842859109243
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 3 Value: 91.46403169701065
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 4 Value: 77.80855078800865
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 5 Value: 67.34357365456181
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 6 Value: 61.56403702376545
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 7 Value: 56.58112464158431
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 8 Value: 52.38871299270271
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 9 Value: 48.43125143638556
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 10 Value: 45.29318730831146
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 11 Value: 42.57535479811654
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 12 Value: 40.34529113769531
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 13 Value: 38.33470775079036
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 14 Value: 36.59371709927269
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 15 Value: 35.18585597915926
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 16 Value: 33.936193529764815
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 17 Value: 32.78813600039137
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 18 Value: 31.805406997514808
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 19 Value: 30.933057808357738
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 20 Value: 30.13727083724478
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 21 Value: 29.376609934412915
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 22 Value: 28.614118103359058
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 23 Value: 27.904084360513135
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 24 Value: 27.279352638082226
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 25 Value: 26.72428362067195
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 26 Value: 26.180589930475623
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 27 Value: 25.649193307282268
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 28 Value: 25.1716290479121
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 29 Value: 24.699816366036732
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 30 Value: 24.27132733395134
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 31 Value: 23.87242154047109
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 32 Value: 23.508599119255507
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 33 Value: 23.13564978224644
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 34 Value: 22.781510602218518
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 35 Value: 22.458602709441944
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 36 Value: 22.134820228210394
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 37 Value: 21.846056407430897
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 38 Value: 21.54472983747289
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 39 Value: 21.24974403882372
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 40 Value: 20.96827271407929
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 41 Value: 20.703979607163998
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 42 Value: 20.435733982618306
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 43 Value: 20.181733025848
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 44 Value: 19.924642826508784
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 45 Value: 19.690351823447408
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 46 Value: 19.451202765582263
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 47 Value: 19.223356223192766
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 48 Value: 19.0116825202237
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 49 Value: 18.80606104766113
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 50 Value: 18.594765545233436
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 51 Value: 18.38631530507751
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 52 Value: 18.210816784786143
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 53 Value: 18.032579082682513
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 54 Value: 17.851684892004815
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 55 Value: 17.695765925144805
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 56 Value: 17.531145527051844
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 57 Value: 17.38426212478375
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 58 Value: 17.216281637938128
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 59 Value: 17.09740388566169
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 60 Value: 16.95721644638241
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 61 Value: 16.830856028674305
Updated
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 62 Value: 16.719855586169423
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 63 Value: 16.59095730505128
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 64 Value: 16.46786611598471
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 65 Value: 16.368937451079272
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 66 Value: 16.261335553725562
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 67 Value: 16.156945139428842
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 68 Value: 16.052455732874247
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 69 Value: 15.959449282072592
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 70 Value: 15.871833668843559
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 71 Value: 15.772544683839964
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 72 Value: 15.697234444341797
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 73 Value: 15.605439174002495
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 74 Value: 15.522416152815888
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 75 Value: 15.441750899345978
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.21s/it]
Loss Epoch: 76 Value: 15.374114302534988
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 77 Value: 15.291361887213112
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 78 Value: 15.227592345942622
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 79 Value: 15.156406038740407
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 80 Value: 15.06980293609094
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 81 Value: 15.01136691250663
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 82 Value: 14.95257013215535
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 83 Value: 14.885635419168334
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 84 Value: 14.819893933983817
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 85 Value: 14.763556642808776
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:43<00:00,  2.21s/it]
Loss Epoch: 86 Value: 14.711766775362733
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:44<00:00,  2.22s/it]
Loss Epoch: 87 Value: 14.648817246288493
Updated
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345/345 [12:45<00:00,  2.22s/it]
Loss Epoch: 88 Value: 14.601690542957057
Updated
Traceback (most recent call last):                                                                                                             /345 [12:44<00:00,  2.02s/it]
Loss Epoch: 89 Value: 14.539382241947063
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/serialization.py", line 850, in save
    _save(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/serialization.py", line 1114, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:778] . PytorchStreamWriter failed writing file data/0: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cboned/Projects/OCR-Koopman/main_lkis.py", line 307, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_lkis.py", line 275, in main
    updated, optimal_loss = utils.update_and_save_model_pt(
