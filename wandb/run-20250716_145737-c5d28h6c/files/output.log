Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:57<00:00, 10.99s/it]
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:39<00:00, 10.81s/it]
Loss Epoch: 1 Value: 0.6821607277177426
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:22<00:00, 10.64s/it]
Loss Epoch: 2 Value: 0.27650950613374614
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:57<00:00, 11.00s/it]
Loss Epoch: 3 Value: 0.08483488810467249
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:43<00:00, 10.85s/it]
Loss Epoch: 4 Value: 0.04443618746317581
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:38<00:00, 10.80s/it]
Loss Epoch: 5 Value: 0.028008052814343223
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:36<00:00, 10.78s/it]
Loss Epoch: 6 Value: 0.019442086116938224
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:41<00:00, 10.83s/it]
Loss Epoch: 7 Value: 0.014108695292949905
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:38<00:00, 10.80s/it]
Loss Epoch: 8 Value: 0.010855758600994204
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:32<00:00, 10.74s/it]
Loss Epoch: 9 Value: 0.008879028535412378
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:47<00:00, 10.90s/it]
Loss Epoch: 10 Value: 0.008003267014401547
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:38<00:00, 10.80s/it]
Loss Epoch: 11 Value: 0.007074057431778709
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:36<00:00, 10.78s/it]
Loss Epoch: 12 Value: 0.006408249050968598
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:34<00:00, 10.76s/it]
Loss Epoch: 13 Value: 0.005731215193046243
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:36<00:00, 10.79s/it]
Loss Epoch: 14 Value: 0.005388567186428747
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:31<00:00, 10.73s/it]
Loss Epoch: 15 Value: 0.005122893339477964
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:40<00:00, 10.82s/it]
Loss Epoch: 16 Value: 0.004806766029198153
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:32<00:00, 10.74s/it]
Loss Epoch: 17 Value: 0.0043864116476247635
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:34<00:00, 10.76s/it]
Loss Epoch: 18 Value: 0.004181645446472115
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:35<00:00, 10.77s/it]
Loss Epoch: 19 Value: 0.003887080964088863
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:30<00:00, 10.72s/it]
Loss Epoch: 20 Value: 0.0036036959418383123
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:38<00:00, 10.80s/it]
Loss Epoch: 21 Value: 0.003412625947986475
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:37<00:00, 10.79s/it]
Loss Epoch: 22 Value: 0.0032612285024010723
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:52<00:00,  9.11s/it]
Loss Epoch: 23 Value: 0.0031971271330673645
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:28<00:00,  9.47s/it]
Loss Epoch: 24 Value: 0.002935509865688355
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:56<00:00,  9.15s/it]
Loss Epoch: 25 Value: 0.0027980638376865668
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:30<00:00,  9.49s/it]
Loss Epoch: 26 Value: 0.0027438794831865306
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:57<00:00,  9.16s/it]
Loss Epoch: 27 Value: 0.0026323523329758285
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:22<00:00,  9.41s/it]
Loss Epoch: 28 Value: 0.0023827268590009354
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:00<00:00,  9.18s/it]
Loss Epoch: 29 Value: 0.002249852759131481
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:16<00:00,  9.35s/it]
Loss Epoch: 30 Value: 0.0022106496386668927
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:03<00:00,  9.22s/it]
Loss Epoch: 31 Value: 0.002185951180392146
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:11<00:00,  9.30s/it]
Loss Epoch: 32 Value: 0.002159902208256185
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:03<00:00,  9.21s/it]
Loss Epoch: 33 Value: 0.0020457317555619926
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:04<00:00,  9.23s/it]
Loss Epoch: 34 Value: 0.0018668192940599604
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:08<00:00,  9.27s/it]
Loss Epoch: 35 Value: 0.0018440322342030413
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:06<00:00,  9.25s/it]
Loss Epoch: 36 Value: 0.0018193949259159349
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:08<00:00,  9.27s/it]
Loss Epoch: 37 Value: 0.001789218767387457
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:04<00:00,  9.23s/it]
Loss Epoch: 38 Value: 0.001711960494782145
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:05<00:00,  9.24s/it]
Loss Epoch: 39 Value: 0.0014802796510074196
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:03<00:00,  9.22s/it]
Loss Epoch: 40 Value: 0.0011567743317198397
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:00<00:00,  9.19s/it]
Loss Epoch: 41 Value: 0.0008578076022480004
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:01<00:00,  9.20s/it]
Loss Epoch: 42 Value: 0.0006916992496469122
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:54<00:00,  9.12s/it]
Loss Epoch: 43 Value: 0.0005985345098535469
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:59<00:00,  9.18s/it]
Loss Epoch: 44 Value: 0.0004745598758926444
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:42<00:00,  9.01s/it]
Loss Epoch: 45 Value: 0.00029212290812271317
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:02<00:00,  9.21s/it]
Loss Epoch: 46 Value: 0.00027078973324612854
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:41<00:00,  8.99s/it]
Loss Epoch: 47 Value: 0.00025864021552662533
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:01<00:00,  9.20s/it]
Loss Epoch: 48 Value: 0.00024793381604416826
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:41<00:00,  8.99s/it]
Loss Epoch: 49 Value: 0.00019908153555315856
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:01<00:00,  9.20s/it]
Loss Epoch: 50 Value: 0.00014819541849138957
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:39<00:00,  8.97s/it]
Loss Epoch: 51 Value: 0.00013064806171068043
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:02<00:00,  9.20s/it]
Loss Epoch: 52 Value: 4.903905503891009e-05
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:34<00:00,  8.92s/it]
Loss Epoch: 53 Value: 4.972876026575456e-05
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:07<00:00,  9.26s/it]
Loss Epoch: 54 Value: 0.0025296933474090047
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:33<00:00,  8.91s/it]
Loss Epoch: 55 Value: 0.0039114087120818725
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:07<00:00,  9.26s/it]
Loss Epoch: 56 Value: 0.0024519373229330605
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:32<00:00,  8.91s/it]
Loss Epoch: 57 Value: 0.0019362494153845509
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:01<00:00,  9.20s/it]
Loss Epoch: 58 Value: 0.001655006630931077
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:39<00:00,  8.97s/it]
Loss Epoch: 59 Value: 0.0014352591691634616
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:57<00:00,  9.15s/it]
Loss Epoch: 60 Value: 0.00118291003740041
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:42<00:00,  9.01s/it]
Loss Epoch: 61 Value: 0.0010670668712102307
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:52<00:00,  9.11s/it]
Loss Epoch: 62 Value: 0.0009667628709190022
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:39<00:00,  8.98s/it]
Loss Epoch: 63 Value: 0.0008375500949708167
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:55<00:00,  9.14s/it]
Loss Epoch: 64 Value: 0.0007902987181296339
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:34<00:00,  8.92s/it]
Loss Epoch: 65 Value: 0.0007354706422398633
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [15:04<00:00,  9.23s/it]
Loss Epoch: 66 Value: 0.0007028878095873236
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:37<00:00,  8.96s/it]
Loss Epoch: 67 Value: 0.0006427647972486739
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [16:54<00:00, 10.35s/it]
Loss Epoch: 68 Value: 0.000654026013215079
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [14:37<00:00,  8.95s/it]
Loss Epoch: 69 Value: 0.0005714630655329158
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [16:00<00:00,  9.80s/it]
Loss Epoch: 70 Value: 0.0005418738011049216
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [16:49<00:00, 10.30s/it]
Loss Epoch: 71 Value: 0.0005753942669724317
Training Procedure:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 79/98 [13:45<03:18, 10.44s/it]
Loss Epoch: 72 Value: 0.0005227890169686473
Traceback (most recent call last):                                                                                                                                                                                                     
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 206, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 156, in main
    _, metrics = train_lkis_task(
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 160, in train_lkis_task
    features = teacher_model_encoder(**inputs, output_hidden_states=True)["hidden_states"]  # Shape [batch_size, Seq + 1, 768] -> Shape [batch_size, 768] Get the cls
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_models.py", line 343, in forward
    self.residuals.clear()
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 406, in forward
    outputs = self.resnet(pixel_values, output_hidden_states=output_hidden_states, return_dict=return_dict)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 347, in forward
    encoder_outputs = self.encoder(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 250, in forward
    hidden_state = stage_module(hidden_state)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/transformers/models/resnet/modeling_resnet.py", line 219, in forward
    hidden_state = layer(hidden_state)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1844, in _call_impl
    return inner()
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1803, in inner
    hook_result = hook(self, args, result)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_models.py", line 335, in _hook_fn
KeyboardInterrupt
