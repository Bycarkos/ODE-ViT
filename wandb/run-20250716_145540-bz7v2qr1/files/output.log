Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:55<00:00, 10.97s/it]
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [18:00<00:00, 11.03s/it]
Loss Epoch: 1 Value: 0.2857967024022827
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:54<00:00, 10.96s/it]
Loss Epoch: 2 Value: 0.08389887348416128
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [18:10<00:00, 11.13s/it]
Loss Epoch: 3 Value: 0.00994194649312555
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:59<00:00, 11.02s/it]
Loss Epoch: 4 Value: 0.001140478883575715
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:46<00:00, 10.88s/it]
Loss Epoch: 5 Value: 0.0003257536501450886
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:36<00:00, 10.78s/it]
Loss Epoch: 6 Value: 0.00014383527542581853
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:41<00:00, 10.83s/it]
Loss Epoch: 7 Value: 7.448851710023519e-05
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:39<00:00, 10.81s/it]
Loss Epoch: 8 Value: 4.298649618422179e-05
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:34<00:00, 10.76s/it]
Loss Epoch: 9 Value: 2.715698797181417e-05
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:57<00:00, 11.00s/it]
Loss Epoch: 10 Value: 1.8239952997241606e-05
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:39<00:00, 10.81s/it]
Loss Epoch: 11 Value: 1.2608835930542594e-05
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:37<00:00, 10.79s/it]
Loss Epoch: 12 Value: 9.224367669774865e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:34<00:00, 10.76s/it]
Loss Epoch: 13 Value: 7.00691500025458e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:38<00:00, 10.80s/it]
Loss Epoch: 14 Value: 5.485509181403474e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:30<00:00, 10.72s/it]
Loss Epoch: 15 Value: 4.451163234931795e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:40<00:00, 10.82s/it]
Loss Epoch: 16 Value: 3.6534310252815133e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:33<00:00, 10.75s/it]
Loss Epoch: 17 Value: 3.0499158388660623e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:34<00:00, 10.76s/it]
Loss Epoch: 18 Value: 2.574338713702296e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:35<00:00, 10.77s/it]
Loss Epoch: 19 Value: 2.2230317602063196e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:33<00:00, 10.75s/it]
Loss Epoch: 20 Value: 1.8910687831446096e-06
Updated
Training Procedure: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [17:36<00:00, 10.78s/it]
Loss Epoch: 21 Value: 1.6887490341813083e-06
Updated
Training Procedure:  15%|████████████████████████▌                                                                                                                                             | 22/149 [6:30:25<37:17:40, 1057.17s/it]/home/cboned/Projects/OCR-Koopman/lkis.py:21: UserWarning: torch.linalg.svd: During SVD computation with the selected cusolver driver, batches 0 failed to converge. A more accurate method will be used to compute the SVD as a fallback. Check doc at https://pytorch.org/docs/stable/generated/torch.linalg.svd.html (Triggered internally at ../aten/src/ATen/native/cuda/linalg/BatchLinearAlgebraLib.cpp:697.)
Loss Epoch: 22 Value: 1.168469026818888e-06
Updated
  g0pinv = torch.pinverse(g0)████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 88/98 [15:51<01:47, 10.73s/it]
Training Procedure:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 88/98 [16:02<01:49, 10.94s/it]
Traceback (most recent call last):                                                                                                                                                                                                     
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 206, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_lkis_classification.py", line 156, in main
    _, metrics = train_lkis_task(
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 182, in train_lkis_task
    tmp_loss, losses_desglosed = criterion(y0, y1, g0, g1, h0, h1, dim_y=h0.shape[1])
  File "/home/cboned/Projects/OCR-Koopman/lkis.py", line 101, in KoopmanLoss
    K = ls_solution(g0, g1)
  File "/home/cboned/Projects/OCR-Koopman/lkis.py", line 21, in ls_solution
    g0pinv = torch.pinverse(g0)
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 2).
