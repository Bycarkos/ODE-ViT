Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
CREATING THE BASELINE METRIC VALUE
 STARTING TO EVALUATE FO THE FIRST TIME
val Procedure: 24it [00:49,  2.08s/it]
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:08<00:00,  1.52s/it]
Validation Loss Epoch: 0 Value: 4.604390506744385 Optimal_loss: 4.604390506744385
val Procedure: 24it [00:41,  1.74s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:08<00:00,  2.72s/it]
Loss Epoch: 1 Value: 4.544418374938195
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:13<00:00,  1.53s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.409952583312989 Optimal_loss: 4.409952583312989
val Procedure: 24it [00:45,  1.90s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:13<00:00,  2.02s/it]
Loss Epoch: 2 Value: 4.025726774003771
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:40<00:00,  1.56s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.598019781112671 Optimal_loss: 3.598019781112671
val Procedure: 24it [00:46,  1.95s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:40<00:00,  2.19s/it]
Loss Epoch: 3 Value: 2.9780875550376043
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:34<00:00,  1.55s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.476078863143921 Optimal_loss: 2.476078863143921
val Procedure: 24it [00:48,  2.02s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:34<00:00,  3.18s/it]
Loss Epoch: 4 Value: 1.8671530341861224
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:11<00:00,  1.53s/it]
Model Updated: Validation Loss Epoch: 0 Value: 1.4858967399597167 Optimal_loss: 1.4858967399597167
val Procedure: 24it [00:45,  1.88s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:11<00:00,  1.87s/it]
Loss Epoch: 5 Value: 0.981056607130802
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:35<00:00,  1.55s/it]
Model Updated: Validation Loss Epoch: 0 Value: 0.7818554425239563 Optimal_loss: 0.7818554425239563
val Procedure: 24it [00:52,  2.18s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:35<00:00,  1.94s/it]
Loss Epoch: 6 Value: 0.47080297656733583
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:05<00:00,  1.52s/it]
Model Updated: Validation Loss Epoch: 0 Value: 0.5410579514503479 Optimal_loss: 0.5410579514503479
val Procedure: 24it [00:49,  2.05s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:04<00:00,  2.12s/it]
Loss Epoch: 7 Value: 0.24769954679891318
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:15<00:00,  1.53s/it]
Model Updated: Validation Loss Epoch: 0 Value: 0.385592006444931 Optimal_loss: 0.385592006444931
val Procedure: 24it [00:56,  2.34s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:14<00:00,  2.20s/it]
Loss Epoch: 8 Value: 0.14514136070554906
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:29<00:00,  1.54s/it]
val Procedure: 24it [00:51,  2.15s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:28<00:00,  2.58s/it]
Loss Epoch: 9 Value: 0.09204550510404086
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:18<00:00,  1.53s/it]
Model Updated: Validation Loss Epoch: 0 Value: 0.2960400679707527 Optimal_loss: 0.2960400679707527
val Procedure: 24it [00:50,  2.12s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:18<00:00,  1.95s/it]
Loss Epoch: 10 Value: 0.062094500301537486
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:47<00:00,  1.56s/it]
val Procedure: 24it [00:46,  1.95s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:47<00:00,  2.83s/it]
Loss Epoch: 11 Value: 0.04231919880316715
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:20<00:00,  1.54s/it]
val Procedure: 24it [00:46,  1.93s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:20<00:00,  1.92s/it]
Loss Epoch: 12 Value: 0.03072410729629072
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:18<00:00,  1.53s/it]
val Procedure: 24it [00:50,  2.12s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:18<00:00,  1.96s/it]
Loss Epoch: 13 Value: 0.023861478385280327
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:19<00:00,  1.54s/it]
Model Updated: Validation Loss Epoch: 0 Value: 0.2650033139437437 Optimal_loss: 0.2650033139437437
val Procedure: 24it [00:41,  1.75s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:19<00:00,  2.07s/it]
Loss Epoch: 14 Value: 0.017172517517882617
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:22<00:00,  1.54s/it]
val Procedure: 24it [00:58,  2.42s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:22<00:00,  2.01s/it]
Loss Epoch: 15 Value: 0.013391533360882389
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:02<00:00,  1.52s/it]
val Procedure: 24it [00:50,  2.12s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:02<00:00,  2.11s/it]
Loss Epoch: 16 Value: 0.012927293393177667
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:45<00:00,  1.56s/it]
val Procedure: 24it [00:46,  1.95s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:44<00:00,  1.93s/it]
Loss Epoch: 17 Value: 0.009648021998241394
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:29<00:00,  1.55s/it]
val Procedure: 24it [00:49,  2.07s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:29<00:00,  2.00s/it]
Loss Epoch: 18 Value: 0.008889587590649648
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:08<00:00,  1.52s/it]
val Procedure: 24it [00:50,  2.09s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:08<00:00,  1.99s/it]
Loss Epoch: 19 Value: 0.0064846829391282165
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:25<00:00,  1.54s/it]
val Procedure: 24it [00:50,  2.12s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:25<00:00,  2.11s/it]
Loss Epoch: 20 Value: 0.006764250744552812
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:44<00:00,  1.56s/it]
val Procedure: 24it [00:44,  1.87s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:44<00:00,  1.90s/it]
Loss Epoch: 21 Value: 0.006279345340744564
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:18<00:00,  1.53s/it]
Model Updated: Validation Loss Epoch: 0 Value: 0.21681107338983566 Optimal_loss: 0.21681107338983566
val Procedure: 24it [00:51,  2.13s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:17<00:00,  1.80s/it]
Loss Epoch: 22 Value: 0.004532215029713839
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:28<00:00,  1.54s/it]
val Procedure: 24it [00:45,  1.91s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:28<00:00,  2.16s/it]
Loss Epoch: 23 Value: 0.004374376571186903
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:15<00:00,  1.53s/it]
val Procedure: 24it [00:54,  2.27s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:15<00:00,  1.98s/it]
Loss Epoch: 24 Value: 0.005147988936391123
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:13<00:00,  1.53s/it]
val Procedure: 24it [00:51,  2.16s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:12<00:00,  2.08s/it]
Loss Epoch: 25 Value: 0.003974155540492226
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:37<00:00,  1.55s/it]
val Procedure: 24it [00:48,  2.03s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:37<00:00,  2.06s/it]
Loss Epoch: 26 Value: 0.0034043710927227325
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:45<00:00,  1.56s/it]
val Procedure: 24it [00:53,  2.21s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:45<00:00,  1.84s/it]
Loss Epoch: 27 Value: 0.0029618243275579496
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:13<00:00,  1.53s/it]
val Procedure: 24it [00:52,  2.20s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:13<00:00,  2.33s/it]
Loss Epoch: 28 Value: 0.0034544560435931246
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:22<00:00,  1.54s/it]
val Procedure: 24it [00:49,  2.07s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:22<00:00,  2.10s/it]
Loss Epoch: 29 Value: 0.003564569835593416
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:37<00:00,  1.55s/it]
val Procedure: 24it [00:45,  1.88s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:37<00:00,  2.25s/it]
Loss Epoch: 30 Value: 0.0024208526381919388
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:08<00:00,  1.52s/it]
val Procedure: 24it [00:53,  2.22s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:08<00:00,  3.02s/it]
Loss Epoch: 31 Value: 0.0019675461503217287
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:21<00:00,  1.54s/it]
val Procedure: 24it [00:46,  1.93s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:21<00:00,  2.94s/it]
Loss Epoch: 32 Value: 0.0019197037998549265
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:26<00:00,  1.60s/it]
val Procedure: 24it [00:50,  2.11s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:25<00:00,  2.66s/it]
Loss Epoch: 33 Value: 0.0019052853007304642
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:36<00:00,  1.55s/it]
val Procedure: 24it [00:42,  1.76s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [25:35<00:00,  2.14s/it]
Loss Epoch: 34 Value: 0.005087123337440484
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:08<00:00,  1.58s/it]
val Procedure: 24it [00:43,  1.80s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:08<00:00,  2.13s/it]
Loss Epoch: 35 Value: 0.0017062368765097073
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:02<00:00,  1.58s/it]
val Procedure: 24it [00:48,  2.02s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:02<00:00,  1.90s/it]
Loss Epoch: 36 Value: 0.0012806438897369485
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:21<00:00,  1.60s/it]
val Procedure: 24it [00:50,  2.11s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [26:21<00:00,  1.86s/it]
Loss Epoch: 37 Value: 0.0013617943596204206
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:15<00:00,  1.77s/it]
val Procedure: 24it [00:50,  2.11s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:15<00:00,  2.17s/it]
Loss Epoch: 38 Value: 0.0014091944148542943
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [30:03<00:00,  1.82s/it]
val Procedure: 24it [00:47,  1.97s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [30:03<00:00,  2.07s/it]
Loss Epoch: 39 Value: 0.004170542441635108
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [30:11<00:00,  1.83s/it]
val Procedure: 24it [00:54,  2.27s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [30:11<00:00,  2.44s/it]
Loss Epoch: 40 Value: 0.001880008402422207
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:31<00:00,  1.79s/it]
val Procedure: 24it [00:46,  1.95s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:31<00:00,  2.67s/it]
Loss Epoch: 41 Value: 0.0014791396220456903
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:42<00:00,  1.80s/it]
val Procedure: 24it [00:54,  2.28s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:41<00:00,  2.28s/it]
Loss Epoch: 42 Value: 0.00113260476101652
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:53<00:00,  1.81s/it]
val Procedure: 24it [00:57,  2.41s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:53<00:00,  2.11s/it]
Loss Epoch: 43 Value: 0.001103789219066837
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:00<00:00,  1.76s/it]
val Procedure: 24it [00:42,  1.79s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:00<00:00,  1.97s/it]
Loss Epoch: 44 Value: 0.001415862842744294
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:12<00:00,  1.77s/it]
val Procedure: 24it [00:42,  1.79s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:12<00:00,  2.21s/it]
Loss Epoch: 45 Value: 0.0023315917309685236
Training Procedure: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:17<00:00,  1.78s/it]
val Procedure: 24it [00:48,  2.01s/it]████████████████████████████████████████████████████████████████████████████████████████████| 990/990 [29:17<00:00,  2.33s/it]
Loss Epoch: 46 Value: 0.0013468113473944032
Training Procedure:  13%|███████████████████▎                                                                                                                                | 129/990 [03:57<26:25,  1.84s/it]
Traceback (most recent call last):                                                                                                                                           | 129/990 [03:50<17:33,  1.22s/it]
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/PIL/ImageFile.py", line 643, in _save
    fh = fp.fileno()
AttributeError: '_idat' object has no attribute 'fileno'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cboned/Projects/OCR-Koopman/main_classification.py", line 204, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_classification.py", line 123, in main
    dataloader=train_dloader,
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 80, in train_classification_task
    "loss_stability_iter": metrics_iter["loss_stability_iter"] + losses_desglosed["loss_stability"],
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/wandb/sdk/data_types/image.py", line 178, in __init__
    self._initialize_from_data(data_or_path, mode, file_type)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/wandb/sdk/data_types/image.py", line 338, in _initialize_from_data
    self._image.save(tmp_path, transparency=None)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/PIL/Image.py", line 2581, in save
    save_handler(self, fp, filename)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/PIL/PngImagePlugin.py", line 1492, in _save
    ImageFile._save(
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/PIL/ImageFile.py", line 647, in _save
    _encode_tile(im, fp, tile, bufsize, None, exc)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/PIL/ImageFile.py", line 673, in _encode_tile
    errcode, data = encoder.encode(bufsize)[1:]
KeyboardInterrupt
