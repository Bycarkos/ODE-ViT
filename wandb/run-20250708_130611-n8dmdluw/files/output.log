Some weights of the model checkpoint at /data/users/cboned/checkpoints/Vit_CIFAR100_first_train_reduced.pt were not used when initializing ViTForImageClassification: ['vit.encoder.layer.1.attention.attention.key.bias', 'vit.encoder.layer.1.attention.attention.key.weight', 'vit.encoder.layer.1.attention.attention.query.bias', 'vit.encoder.layer.1.attention.attention.query.weight', 'vit.encoder.layer.1.attention.attention.value.bias', 'vit.encoder.layer.1.attention.attention.value.weight', 'vit.encoder.layer.1.attention.output.dense.bias', 'vit.encoder.layer.1.attention.output.dense.weight', 'vit.encoder.layer.1.intermediate.dense.bias', 'vit.encoder.layer.1.intermediate.dense.weight', 'vit.encoder.layer.1.layernorm_after.bias', 'vit.encoder.layer.1.layernorm_after.weight', 'vit.encoder.layer.1.layernorm_before.bias', 'vit.encoder.layer.1.layernorm_before.weight', 'vit.encoder.layer.1.output.dense.bias', 'vit.encoder.layer.1.output.dense.weight', 'vit.encoder.layer.10.attention.attention.key.bias', 'vit.encoder.layer.10.attention.attention.key.weight', 'vit.encoder.layer.10.attention.attention.query.bias', 'vit.encoder.layer.10.attention.attention.query.weight', 'vit.encoder.layer.10.attention.attention.value.bias', 'vit.encoder.layer.10.attention.attention.value.weight', 'vit.encoder.layer.10.attention.output.dense.bias', 'vit.encoder.layer.10.attention.output.dense.weight', 'vit.encoder.layer.10.intermediate.dense.bias', 'vit.encoder.layer.10.intermediate.dense.weight', 'vit.encoder.layer.10.layernorm_after.bias', 'vit.encoder.layer.10.layernorm_after.weight', 'vit.encoder.layer.10.layernorm_before.bias', 'vit.encoder.layer.10.layernorm_before.weight', 'vit.encoder.layer.10.output.dense.bias', 'vit.encoder.layer.10.output.dense.weight', 'vit.encoder.layer.11.attention.attention.key.bias', 'vit.encoder.layer.11.attention.attention.key.weight', 'vit.encoder.layer.11.attention.attention.query.bias', 'vit.encoder.layer.11.attention.attention.query.weight', 'vit.encoder.layer.11.attention.attention.value.bias', 'vit.encoder.layer.11.attention.attention.value.weight', 'vit.encoder.layer.11.attention.output.dense.bias', 'vit.encoder.layer.11.attention.output.dense.weight', 'vit.encoder.layer.11.intermediate.dense.bias', 'vit.encoder.layer.11.intermediate.dense.weight', 'vit.encoder.layer.11.layernorm_after.bias', 'vit.encoder.layer.11.layernorm_after.weight', 'vit.encoder.layer.11.layernorm_before.bias', 'vit.encoder.layer.11.layernorm_before.weight', 'vit.encoder.layer.11.output.dense.bias', 'vit.encoder.layer.11.output.dense.weight', 'vit.encoder.layer.2.attention.attention.key.bias', 'vit.encoder.layer.2.attention.attention.key.weight', 'vit.encoder.layer.2.attention.attention.query.bias', 'vit.encoder.layer.2.attention.attention.query.weight', 'vit.encoder.layer.2.attention.attention.value.bias', 'vit.encoder.layer.2.attention.attention.value.weight', 'vit.encoder.layer.2.attention.output.dense.bias', 'vit.encoder.layer.2.attention.output.dense.weight', 'vit.encoder.layer.2.intermediate.dense.bias', 'vit.encoder.layer.2.intermediate.dense.weight', 'vit.encoder.layer.2.layernorm_after.bias', 'vit.encoder.layer.2.layernorm_after.weight', 'vit.encoder.layer.2.layernorm_before.bias', 'vit.encoder.layer.2.layernorm_before.weight', 'vit.encoder.layer.2.output.dense.bias', 'vit.encoder.layer.2.output.dense.weight', 'vit.encoder.layer.3.attention.attention.key.bias', 'vit.encoder.layer.3.attention.attention.key.weight', 'vit.encoder.layer.3.attention.attention.query.bias', 'vit.encoder.layer.3.attention.attention.query.weight', 'vit.encoder.layer.3.attention.attention.value.bias', 'vit.encoder.layer.3.attention.attention.value.weight', 'vit.encoder.layer.3.attention.output.dense.bias', 'vit.encoder.layer.3.attention.output.dense.weight', 'vit.encoder.layer.3.intermediate.dense.bias', 'vit.encoder.layer.3.intermediate.dense.weight', 'vit.encoder.layer.3.layernorm_after.bias', 'vit.encoder.layer.3.layernorm_after.weight', 'vit.encoder.layer.3.layernorm_before.bias', 'vit.encoder.layer.3.layernorm_before.weight', 'vit.encoder.layer.3.
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Loaded keys: <All keys matched successfully>
CREATING THE BASELINE METRIC VALUE
 STARTING TO EVALUATE FO THE FIRST TIME
val Procedure: 24it [00:09,  2.65it/s]
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:49<00:00,  5.46s/it]
Validation Loss Epoch: 0 Value: 5.357743625640869 Optimal_loss: 5.357743625640869
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:49<00:00,  4.44s/it]
Loss Epoch: 1 Value: 5.11294412612915
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:44<00:00,  5.43s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.78688835144043 Optimal_loss: 4.78688835144043
val Procedure: 24it [00:07,  3.08it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:44<00:00,  4.45s/it]
Loss Epoch: 2 Value: 4.648964641045551
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:45<00:00,  5.44s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.5415036010742185 Optimal_loss: 4.5415036010742185
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:45<00:00,  4.44s/it]
Loss Epoch: 3 Value: 4.513523960600094
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:43<00:00,  5.43s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.432341728210449 Optimal_loss: 4.432341728210449
val Procedure: 24it [00:07,  3.11it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:43<00:00,  4.43s/it]
Loss Epoch: 4 Value: 4.375510004101967
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:43<00:00,  5.43s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.289824829101563 Optimal_loss: 4.289824829101563
val Procedure: 24it [00:08,  2.97it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:43<00:00,  4.43s/it]
Loss Epoch: 5 Value: 4.2251675323564175
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:43<00:00,  5.43s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.167113494873047 Optimal_loss: 4.167113494873047
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:43<00:00,  4.43s/it]
Loss Epoch: 6 Value: 4.109676820891244
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:42<00:00,  5.42s/it]
Model Updated: Validation Loss Epoch: 0 Value: 4.108176431655884 Optimal_loss: 4.108176431655884
val Procedure: 24it [00:07,  3.04it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:42<00:00,  4.42s/it]
Loss Epoch: 7 Value: 3.9890687538653005
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:50<00:00,  5.46s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.8501390743255617 Optimal_loss: 3.8501390743255617
val Procedure: 24it [00:06,  3.73it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:50<00:00,  4.70s/it]
Loss Epoch: 8 Value: 3.837211262206642
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [18:20<00:00,  5.62s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.751849527359009 Optimal_loss: 3.751849527359009
val Procedure: 24it [00:08,  2.95it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [18:20<00:00,  4.43s/it]
Loss Epoch: 9 Value: 3.7069804644098086
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:51<00:00,  5.47s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.7183074283599855 Optimal_loss: 3.7183074283599855
val Procedure: 24it [00:07,  3.06it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:51<00:00,  4.43s/it]
Loss Epoch: 10 Value: 3.6039046182924386
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:45<00:00,  5.44s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.4997986793518066 Optimal_loss: 3.4997986793518066
val Procedure: 24it [00:08,  2.87it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:45<00:00,  4.44s/it]
Loss Epoch: 11 Value: 3.514060392671702
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:45<00:00,  5.44s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.4694252586364747 Optimal_loss: 3.4694252586364747
val Procedure: 24it [00:07,  3.09it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:45<00:00,  4.45s/it]
Loss Epoch: 12 Value: 3.412223537357486
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [14:20<00:00,  4.39s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.449986639022827 Optimal_loss: 3.449986639022827
val Procedure: 24it [00:03,  6.52it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [14:20<00:00,  2.00s/it]
Loss Epoch: 13 Value: 3.314157387431787
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:38<00:00,  2.65s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.324520034790039 Optimal_loss: 3.324520034790039
val Procedure: 24it [00:02,  8.82it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [08:38<00:00,  2.13s/it]
Loss Epoch: 14 Value: 3.2348577939734167
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [16:35<00:00,  5.08s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.152188444137573 Optimal_loss: 3.152188444137573
val Procedure: 24it [00:07,  3.08it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [16:35<00:00,  4.41s/it]
Loss Epoch: 15 Value: 3.150732783638701
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:57<00:00,  5.50s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.092266073226929 Optimal_loss: 3.092266073226929
val Procedure: 24it [00:08,  2.90it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:57<00:00,  4.54s/it]
Loss Epoch: 16 Value: 3.0783446820414797
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:46<00:00,  5.44s/it]
Model Updated: Validation Loss Epoch: 0 Value: 3.0881562995910645 Optimal_loss: 3.0881562995910645
val Procedure: 24it [00:08,  2.95it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:46<00:00,  4.41s/it]
Loss Epoch: 17 Value: 3.0139471073539887
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:36<00:00,  5.39s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.969367837905884 Optimal_loss: 2.969367837905884
val Procedure: 24it [00:07,  3.17it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:36<00:00,  4.42s/it]
Loss Epoch: 18 Value: 2.950333912761844
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.885334873199463 Optimal_loss: 2.885334873199463
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 19 Value: 2.9072964763154787
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.14it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  4.41s/it]
Loss Epoch: 20 Value: 2.8692491297819176
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 21 Value: 2.8309309798844007
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.39s/it]
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:36<00:00,  4.42s/it]
Loss Epoch: 22 Value: 2.7955803275108337
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:33<00:00,  5.37s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.788996334075928 Optimal_loss: 2.788996334075928
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:33<00:00,  3.85s/it]
Loss Epoch: 23 Value: 2.7757850167702656
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.97it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 24 Value: 2.7625645228794644
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.749654369354248 Optimal_loss: 2.749654369354248
val Procedure: 24it [00:07,  3.00it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 25 Value: 2.735890631773034
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.10it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 26 Value: 2.718892039084921
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.00it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.42s/it]
Loss Epoch: 27 Value: 2.7072013859846153
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.81it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 28 Value: 2.672558469431741
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.41s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.6486403369903564 Optimal_loss: 2.6486403369903564
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  4.41s/it]
Loss Epoch: 29 Value: 2.646289488490747
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.6443645191192626 Optimal_loss: 2.6443645191192626
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 30 Value: 2.626995705828375
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  5.37s/it]
val Procedure: 24it [00:08,  2.79it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  4.27s/it]
Loss Epoch: 31 Value: 2.6001491643944563
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  4.42s/it]
Loss Epoch: 32 Value: 2.570521804751182
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.04it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 33 Value: 2.5351052454539706
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.14it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 34 Value: 2.5087095255754432
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:36<00:00,  5.39s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.596477565765381 Optimal_loss: 2.596477565765381
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:36<00:00,  4.42s/it]
Loss Epoch: 35 Value: 2.4885688655230465
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.5810815620422365 Optimal_loss: 2.5810815620422365
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 36 Value: 2.4599207858650054
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 37 Value: 2.4451489375562083
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.4940634775161743 Optimal_loss: 2.4940634775161743
val Procedure: 24it [00:07,  3.14it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.40s/it]
Loss Epoch: 38 Value: 2.4182113810461394
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:33<00:00,  5.38s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.488057909011841 Optimal_loss: 2.488057909011841
val Procedure: 24it [00:08,  2.96it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:33<00:00,  4.38s/it]
Loss Epoch: 39 Value: 2.4066054151982677
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.02it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 40 Value: 2.3758542817466113
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.451089506149292 Optimal_loss: 2.451089506149292
val Procedure: 24it [00:07,  3.11it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 41 Value: 2.3592941420418874
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.99it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 42 Value: 2.3441671789908898
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 43 Value: 2.337035241175671
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.92it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 44 Value: 2.324113815414662
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.95it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 45 Value: 2.329848836879341
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.87it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  4.42s/it]
Loss Epoch: 46 Value: 2.31727767355588
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  5.37s/it]
val Procedure: 24it [00:07,  3.14it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  4.41s/it]
Loss Epoch: 47 Value: 2.310613894949154
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.96it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 48 Value: 2.3162641902359162
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.320100154876709 Optimal_loss: 2.320100154876709
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 49 Value: 2.293968465863442
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:08,  2.92it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 50 Value: 2.2976614036122145
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:39<00:00,  4.41s/it]
Loss Epoch: 51 Value: 2.2760606475022374
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 52 Value: 2.258482590013621
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 53 Value: 2.237973618872312
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:06,  3.52it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 54 Value: 2.225647444627723
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:34<00:00,  5.38s/it]
val Procedure: 24it [00:08,  2.88it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:34<00:00,  4.41s/it]
Loss Epoch: 55 Value: 2.207113970907367
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.3003588628768923 Optimal_loss: 2.3003588628768923
val Procedure: 24it [00:07,  3.12it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 56 Value: 2.2082641964056053
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 57 Value: 2.1949199973320472
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 58 Value: 2.197062374985948
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.39s/it]
val Procedure: 24it [00:08,  2.79it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  4.41s/it]
Loss Epoch: 59 Value: 2.1830702138190365
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:37<00:00,  5.39s/it]
Model Updated: Validation Loss Epoch: 0 Value: 2.2553148651123047 Optimal_loss: 2.2553148651123047
val Procedure: 24it [00:08,  2.95it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:36<00:00,  4.41s/it]
Loss Epoch: 60 Value: 2.1875800770156237
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.40s/it]
Loss Epoch: 61 Value: 2.1904279443682455
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  5.37s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  3.67s/it]
Loss Epoch: 62 Value: 2.2034895882314567
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 63 Value: 2.1947252580097745
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.06it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 64 Value: 2.2120582211990745
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.15it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 65 Value: 2.237742315749733
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.16it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 66 Value: 2.2337844268399842
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.14it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 67 Value: 2.251731816603213
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.14it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.41s/it]
Loss Epoch: 68 Value: 2.272292218646225
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  5.40s/it]
val Procedure: 24it [00:07,  3.01it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:38<00:00,  4.42s/it]
Loss Epoch: 69 Value: 2.2748850024476344
Training Procedure: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:33<00:00,  5.37s/it]
val Procedure: 24it [00:07,  3.13it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 196/196 [17:32<00:00,  4.17s/it]
Loss Epoch: 70 Value: 2.2939166049568023
Training Procedure:  51%|███████████████████████████████████████████████████████████████████████████▎                                                                         | 99/196 [09:00<08:49,  5.46s/it]
Traceback (most recent call last):                                                                                                                                                                             
  File "/home/cboned/Projects/OCR-Koopman/main_classification_with_koopman.py", line 224, in <module>
    main(cfg=cfg)
  File "/home/cboned/Projects/OCR-Koopman/main_classification_with_koopman.py", line 162, in main
    _, train_loss = train_classification_with_koopman(
  File "/home/cboned/Projects/OCR-Koopman/train.py", line 45, in train_classification_with_koopman
    output = model(**pixel_values, labels=labels)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_ode.py", line 187, in forward
    self, x: torch.Tensor, t: torch.Tensor = None, save=False
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cboned/Projects/OCR-Koopman/models/wrapper_ode.py", line 130, in forward
    temporal_embedding = self.time_embedding(self.t_values)[(t).int()]
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torchdiffeq/_impl/adjoint.py", line 206, in odeint_adjoint
    ans = OdeintAdjointMethod.apply(shapes, func, y0, t, rtol, atol, method, options, event_fn, adjoint_rtol, adjoint_atol,
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torchdiffeq/_impl/adjoint.py", line 24, in forward
    ans = odeint(func, y0, t, rtol=rtol, atol=atol, method=method, options=options, event_fn=event_fn)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torchdiffeq/_impl/odeint.py", line 80, in odeint
    solution = solver.integrate(t)
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torchdiffeq/_impl/solvers.py", line 119, in integrate
    solution[j] = self._linear_interp(t0, t1, y0, y1, t[j])
  File "/home/cboned/miniconda3/envs/graphocr/lib/python3.10/site-packages/torchdiffeq/_impl/solvers.py", line 175, in _linear_interp
    def _linear_interp(self, t0, t1, y0, y1, t):
KeyboardInterrupt
